# Программа для вычисления площади неправильного многоугольника
# Используется метод трапеций (формула площади Гаусса)

calculate_polygon_area <- function() {
  # Считываем количество вершин
  n <- as.integer(readline(prompt = "Введите количество вершин многоугольника (N): "))
  
  # Проверка корректности введенного количества вершин
  if (is.na(n) || n < 3) {
    cat("ОШИБКА: Многоугольник должен иметь как минимум 3 вершины.\n")
    return()
  }
  
  # Инициализация векторов для координат
  x_coords <- numeric(n)
  y_coords <- numeric(n)
  
  # Считываем координаты вершин
  cat("Введите координаты вершин в порядке против часовой стрелки:\n")
  for (i in 1:n) {
    coords <- readline(prompt = paste("Вершина", i, "(x y): "))
    coords_split <- strsplit(coords, " ")[[1]]
    
    # Проверка корректности введенных координат
    if (length(coords_split) != 2) {
      cat("ОШИБКА: Неверный формат координат. Используйте: x y\n")
      return()
    }
    
    x_coords[i] <- as.numeric(coords_split[1])
    y_coords[i] <- as.numeric(coords_split[2])
    
    # Проверка на числовые значения
    if (is.na(x_coords[i]) || is.na(y_coords[i])) {
      cat("ОШИБКА: Координаты должны быть числами.\n")
      return()
    }
  }
  
  # Вычисление площади по формуле площади Гаусса (формула шнуровки)
  area <- 0
  for (i in 1:n) {
    j <- ifelse(i == n, 1, i + 1)  # Замыкаем многоугольник (последняя с первой)
    area <- area + (x_coords[i] * y_coords[j] - x_coords[j] * y_coords[i])
  }
  area <- abs(area) / 2
  
  # Вывод результата
  cat("\nКоординаты вершин многоугольника:\n")
  for (i in 1:n) {
    cat(paste("Вершина", i, ": (", x_coords[i], ",", y_coords[i], ")\n"))
  }
  
  cat("\n--- Ход решения ---\n")
  cat("Формула площади Гаусса: S = 0.5 * |Σ(x_i * y_{i+1} - x_{i+1} * y_i)|\n")
  cat("Вычисленная сумма: ", area * 2, "\n")
  cat("Площадь многоугольника: S = 0.5 * |", area * 2, "| =", area, "\n")
  cat("\nРЕЗУЛЬТАТ: Площадь многоугольника =", area, "\n")
}

# Запуск программы
calculate_polygon_area()

