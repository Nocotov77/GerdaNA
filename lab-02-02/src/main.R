# Программа для расчета площади фигур (ромб, трапеция, эллипс)
# Выполнена в структурном стиле

calculate_area <- function() {
  cat("=== КАЛЬКУЛЯТОР ПЛОЩАДИ ФИГУР ===\n")
  cat("Доступные фигуры: Ромб, Трапеция, Эллипс\n\n")
  
  attempts <- 0
  max_attempts <- 3
  
  while (attempts < max_attempts) {
    # Запрос названия фигуры
    shape <- readline(prompt = "Введите название фигуры: ")
    
    # Приведение к нижнему регистру для удобства сравнения
    shape_lower <- tolower(shape)
    
    # Проверка корректности введенной фигуры
    if (shape_lower %in% c("ромб", "трапеция", "эллипс")) {
      cat(paste("\nВыбрана фигура:", shape, "\n"))
      calculate_specific_area(shape_lower)
      return(TRUE)
    } else {
      attempts <- attempts + 1
      remaining_attempts <- max_attempts - attempts
      
      if (remaining_attempts > 0) {
        cat(paste("Ошибка: Фигура '", shape, "' не найдена.\n", sep = ""))
        cat(paste("Осталось попыток:", remaining_attempts, "\n\n"))
      }
    }
  }
  
  # Превышено количество попыток
  cat("\nПРЕВЫШЕНО максимальное количество некорректных попыток (3)\n")
  cat("Программа завершена из-за некорректных действий пользователя.\n")
  return(FALSE)
}

# Функция для расчета площади конкретной фигуры
calculate_specific_area <- function(shape) {
  if (shape == "ромб") {
    calculate_rhombus_area()
  } else if (shape == "трапеция") {
    calculate_trapezoid_area()
  } else if (shape == "эллипс") {
    calculate_ellipse_area()
  }
}

# Функция для расчета площади ромба
calculate_rhombus_area <- function() {
  cat("\n--- Расчет площади РОМБА ---\n")
  cat("Формула: S = (d1 * d2) / 2\n")
  cat("где d1, d2 - длины диагоналей\n\n")
  
  # Ввод длин диагоналей
  d1 <- as.numeric(readline(prompt = "Введите длину первой диагонали (d1): "))
  d2 <- as.numeric(readline(prompt = "Введите длину второй диагонали (d2): "))
  
  # Проверка корректности введенных данных
  if (is.na(d1) || is.na(d2) || d1 <= 0 || d2 <= 0) {
    cat("ОШИБКА: Диагонали должны быть положительными числами!\n")
    return()
  }
  
  # Расчет площади
  area <- (d1 * d2) / 2
  
  # Вывод решения
  cat("\n--- Ход решения ---\n")
  cat("Длина первой диагонали (d1) =", d1, "\n")
  cat("Длина второй диагонали (d2) =", d2, "\n")
  cat("Площадь ромба S = (d1 * d2) / 2 = (", d1, "*", d2, ") / 2 =", area, "\n")
  cat("\nРЕЗУЛЬТАТ: Площадь ромба =", area, "\n")
}

# Функция для расчета площади трапеции
calculate_trapezoid_area <- function() {
  cat("\n--- Расчет площади ТРАПЕЦИИ ---\n")
  cat("Формула: S = ((a + b) * h) / 2\n")
  cat("где a, b - длины оснований, h - высота\n\n")
  
  # Ввод параметров
  a <- as.numeric(readline(prompt = "Введите длину первого основания (a): "))
  b <- as.numeric(readline(prompt = "Введите длину второго основания (b): "))
  h <- as.numeric(readline(prompt = "Введите высоту трапеции (h): "))
  
  # Проверка корректности введенных данных
  if (is.na(a) || is.na(b) || is.na(h) || a <= 0 || b <= 0 || h <= 0) {
    cat("ОШИБКА: Все параметры должны быть положительными числами!\n")
    return()
  }
  
  # Расчет площади
  area <- ((a + b) * h) / 2
  
  # Вывод решения
  cat("\n--- Ход решения ---\n")
  cat("Длина первого основания (a) =", a, "\n")
  cat("Длина второго основания (b) =", b, "\n")
  cat("Высота трапеции (h) =", h, "\n")
  cat("Площадь трапеции S = ((a + b) * h) / 2 = ((", a, "+", b, ") *", h, ") / 2 =", area, "\n")
  cat("\nРЕЗУЛЬТАТ: Площадь трапеции =", area, "\n")
}

# Функция для расчета площади эллипса
calculate_ellipse_area <- function() {
  cat("\n--- Расчет площади ЭЛЛИПСА ---\n")
  cat("Формула: S = π * a * b\n")
  cat("где a - большая полуось, b - малая полуось\n")
  cat("π (пи) ≈ 3.14159\n\n")
  
  # Ввод полуосей
  a <- as.numeric(readline(prompt = "Введите длину большой полуоси (a): "))
  b <- as.numeric(readline(prompt = "Введите длину малой полуоси (b): "))
  
  # Проверка корректности введенных данных
  if (is.na(a) || is.na(b) || a <= 0 || b <= 0) {
    cat("ОШИБКА: Полуоси должны быть положительными числами!\n")
    return()
  }
  
  # Расчет площади
  area <- pi * a * b
  
  # Вывод решения
  cat("\n--- Ход решения ---\n")
  cat("Длина большой полуоси (a) =", a, "\n")
  cat("Длина малой полуоси (b) =", b, "\n")
  cat("π (пи) ≈", pi, "\n")
  cat("Площадь эллипса S = π * a * b =", pi, "*", a, "*", b, "=", area, "\n")
  cat("\nРЕЗУЛЬТАТ: Площадь эллипса =", area, "\n")
}

# Главная функция программы
main <- function() {
  success <- calculate_area()
  
  if (success) {
    cat("\n")
    cat(strrep("=", 50))
    cat("\nПрограмма успешно завершена!\n")
    cat("Спасибо за использование калькулятора!\n")
  }
}

# Запуск программы
main()

